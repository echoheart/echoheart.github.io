---
layout:     post
title:      移动端常见问题
subtitle:   移动端常见问题
date:       2019-11-23
author:     limantang
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - 移动端
---
# 移动端常见问题





## 设备像素、设备独立像素、CSS像素、分辨率、PPI、devicePixelRatio

### 物理像素(设备像素)(device pixels)
设备像素也成为物理像素, 是显示器的最小单位, 这个像素不一定是一个小圆点或者小正方形, 只是用于显示丰富色彩的一个点, 一个物理像素有三原色(红,蓝绿)不同变换显示不同的色彩

![](https://www.echoheart.cn/img/xiangsudian.png)

### 设备独立像素(device independent pixels)
顾名思义, 独立于设备的像素, 平时所说的2560 * 1600的分辨率不适合玩游戏啊, 改成1080 * 720, 这里的分辨率(不严谨)就是指**设备独立像素**, 这个可以通过`window.screen.width` `window.screen.height`查看
一个设备独立像素可能包含多了**物理像素点**, 包含的越多看起来越清晰

### 像素分辨率
以手机屏幕为例, IPhoneX像素分辨率是1125*2436, 是指屏幕横向能显示1125个**物理像素点**, 纵向能显示2436个**物理像素点**
通常所说的4K屏幕指的是4096*2160

### PPI(pix per inch)
每英寸的物理像素数, 以5.8英寸为例(屏幕对角线长度), 分辨率为1125*2436的iPhone X为例, `ppi = Math.sqrt(1125*1125 + 2436*2436) / 5.8`

### CSS像素
浏览器使用的单位, 用来衡量网页的内容, 比如`div{width: 100px}`, 在一半情况下(缩放比为1), 一个**CSS像素**等于一个**设备独立像素**, 加入屏幕的设备独立像素是1440*960, 如果页面的宽度是720ox, 则视觉上页面的宽度是屏幕的一半
这也解释了为什么把设备独立像素调高之后感觉网页变小了
当页面的缩放比不是1的时候, **CSS像素**和**设备独立像素**不在以1比1对应, 比如当页面放大200%的时候(浏览器页面缩放), **1个CSS像素**对应4个**设备独立像素**, **因为长宽都放大了2倍, 面积放大了4倍**

### devicePixelRatio

`window.devicePixelRatio`是指**物理像素**和**设备独立像素**的比例
`window.devicePixelRatio = 物理像素 / 设备独立像素`
iPhone X的是3

## viewport

### 尺寸区别
- 屏幕尺寸
这里获取到的是设备独立像素
`window.screen.width``window.screen.height`

![](https://www.echoheart.cn/img/shebeiduli.png)

- 窗口尺寸(包含横向竖向滚动条)
`window.innerWidth`
`window.innerHeight`
包含了横向竖向的滚动条

![](https://www.echoheart.cn/img/chuangkouzhicun.png)

- viewport(不包含横向竖向滚动条)

`document.documentElement.clientWidth`
`document.documentElement.clientHeight`
获取视口宽高
不包含横向竖向的滚动条

- HTML尺寸
`document.documentElement.offsetWidth`
`document.documentElement.offsetHeight`
整个页面内容的宽高

- 整个浏览器应用尺寸

`window.outerHeight`
`window.outerWidth`
包含了标签栏书签栏的整个浏览器的尺寸

### visual viewport &  layout viewport

移动端的visual viewport和layout viewport

手机屏幕一半都很窄, 一半不会超过400px
比如网站的侧边栏宽度都设置为10%, 这在PC浏览器(假设宽度为1000px)看起来没什么问题, 但是在手机上(假设为400px)只有40px

可以把layout viewport想象成一个很大的照片, visual viewport想象成一个小窗口, 小窗口在照片上移动时, 可以透过小窗口visual viewport看到照片 layout view的一部分

![](https://www.echoheart.cn/img/visualviewport.png)

- layout viewport是页面渲染时的参考宽高
- visual viewport是移动端视口的设备独立像素
	
**在移动端渲染时,layout viewport默认就是980px, 所以页面元素渲染时就认为窗口(vasul viewport)的宽度也是980px**

### layout viewport

`document.documentElement.clientWidth`
`document.documentElement.clientHeight`

![](https://www.echoheart.cn/img/layoutviewport.png)


### vasul viewport

`window.screen.width`
`window.screen.height`

![](https://www.echoheart.cn/img/screenwidthvasul.png)

### viewport设置

假设页面没有设置viewport, 对于大部分浏览器来说, 页面会以layout viewport宽度去渲染, 然后页面就会被缩放到正好被屏幕容纳

![](https://www.echoheart.cn/img/yemiansuoxiao.png)

部分浏览器也有可能不去自动缩放, 用户需要左滑右滑才能看到所有内容

![](https://www.echoheart.cn/img/meiyousuofang.png)

这时添加一句
`<meta name="viewport” content=“width=device-width”>`
其中`device-width`就是设备独立像素
其实这句话的作用就是让 **layout viewport 等于 vasul viewport**
也就是 **文档的宽度**等于**设备屏幕宽度**

完整的viewport标签
`<meta name="viewport” content=“width=device-width, minimum-scale=1, initial-scale=1, maximum-scale=1”>`

含义: 手机设备宽度(设备独立像素`window.screen.width`)等于文档宽度(`document.documentElement.clientWidth`)

## 移动端的几种适配方案
## viewport适配方案



















以上文章参考了

[A tale of two viewports](https://www.quirksmode.org/mobile/viewports2.html)

[在移动浏览器中使用viewport元标签控制布局](https://developer.mozilla.org/zh-CN/docs/Mobile/Viewport_meta_tag)









